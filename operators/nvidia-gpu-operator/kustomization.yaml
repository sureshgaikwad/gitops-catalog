apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - namespace.yaml
  - operatorgroup.yaml
  - subscription.yaml
  - clusterpolicy.yaml
#  - fix-cdi-hooks-rbac.yaml
#  - fix-cdi-hooks-job.yaml
#  - fix-cdi-hooks-cronjob.yaml

# Note: 
# - fix-cdi-hooks-job runs after the GPU operator is installed and fixes the CDI
#   spec files on all GPU nodes by removing problematic hooks and setting
#   NVIDIA_VISIBLE_DEVICES=all. It uses oc debug to access each node.
# - fix-cdi-hooks-cronjob runs every 5 minutes to continuously fix CDI specs
#   after the device plugin writes them (device plugin needs to write CDI specs
#   to advertise GPUs, then we fix the hooks)

